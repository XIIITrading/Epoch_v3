# System Modification Request

## Dev Rules

1. Do not generate any code without my explicit instructions
2. Do not assume anything (naming conventions, modules, directories). Ask for clarification or request files to read directly.
3. Once the documentation has been reviewed, please request additional information, questions, and specific scripts if not already apparent and obvious.
4. Always include .txt documentation at the end in two files:
   - **AI-readable**: Complete context for use in future AI conversations without requiring the full script directory
   - **Human-readable**: Teaching-focused explanation of how the script works and how to implement similar patterns elsewhere

---

## Business Domain

- Trading (Epoch, Meridian, backtesting) [X]
- Coaching (curriculum, student tools, content) []
- Investment Real Estate []
- W2 / Corporate []
- Other: ***_________*** []

## System / Module Affected

*(Name the specific system, file, or workflow this touches)*

- > Implement a new module / worksheet with the intention of printing the all M5 bars within a single trade, as identified from the backtest worksheet.

## The Problem or Opportunity

*(What happened, what's missing, or what could be better?)*

- > The overall backtest engine has become too complex with a number of calculations and assumptions not resulting in the intended outcome
- > This system has been developed by the AI algo, which has gotten the result to 98% of the way there, but some of the original assumptions made are now taking multiple iterations to move through bugs with useability not improving
- > This improvement will move the backtest implementation back to a state where Claude and I can walk through what I would like to see in a stepwise manner

## Desired End State

*(When this is complete, what does success look like?)*

- > For each trade_id, the entry_time and the exit_time will be pull by the backtest system
- > Between these two timestamps, each M5 bar, grouped by trade_id will be printed in a new worksheet trade_bars.
- > Included in this pull will be the columns:
   - > trade_idi
   - > event_seq
   - > event_time
   - > bars_from_entry
   - > event_type (ENTRY, IN_TRADE, EXIT)
   - > open_price
   - > high_price
   - > low_price
   - > close_price
   - > r_at_event (should be the r value at close)
   - > health_score
   - > vwap
   - > sma9
   - > sma21
   - > vol_roc
   - > vol_delta
   - > cvd_slope
   - > sma_spread
   - > sma_momentum
   - > m5_structure
   - > m15_structure
   - > h1_structure
   - > h4_structure
   - > health_summary
- > These values will be calculated for each 5-Minute bar.
- > To follow polygon dataset the timestamps correspond to the bar open
- > If the trade opens and closes on the same bar then put two lines one for entry and one for exit with the same bar info
- > Will also need to create a document 14_trade_bars.txt and a .json map for this C:\XIIITradingSystems\Epoch\02_zone_system\13_documentation

## Known Touchpoints

*(List any files, databases, integrations, or dependencies you're aware of)*

> All trade data should be pulled directly from the backtest worksheet. This is the central source of truth and working trade identification engine.

> C:\XIIITradingSystems\Epoch\02_zone_system\09_backtest

## Priority

- Urgent — blocking current work [X]
- Next cycle — planned development []
- Future — idea capture for later []

## Additional Context

*(Screenshots, file names, related conversations, or anything else helpful)*

> folder: C:\XIIITradingSystems\Epoch\02_zone_system\09_backtest\processor\trade_bars
optimal_trade calculations reference: C:\XIIITradingSystems\Epoch\02_zone_system\09_backtest\processor\optimal_trade