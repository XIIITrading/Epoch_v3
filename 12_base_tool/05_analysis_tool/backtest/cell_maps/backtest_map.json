{
    "worksheet": "backtest",
    "description": "Backtest results output for Module 09",
    
    "trade_log": {
        "description": "Individual trade records",
        "header_row": 1,
        "data_start_row": 2,
        "columns": {
            "A": {"name": "trade_id", "type": "string", "format": "ticker_MMDDYY_model_HHMM", "example": "LLY_120925_EPCH2_1450"},
            "B": {"name": "date", "type": "date", "format": "YYYY-MM-DD"},
            "C": {"name": "ticker", "type": "string"},
            "D": {"name": "model", "type": "string", "values": ["EPCH1", "EPCH2", "EPCH3", "EPCH4"]},
            "E": {"name": "zone_type", "type": "string", "values": ["PRIMARY", "SECONDARY"]},
            "F": {"name": "direction", "type": "string", "values": ["LONG", "SHORT"]},
            "G": {"name": "zone_high", "type": "float", "format": "price"},
            "H": {"name": "zone_low", "type": "float", "format": "price"},
            "I": {"name": "entry_price", "type": "float", "format": "price"},
            "J": {"name": "entry_time", "type": "time", "format": "HH:MM:SS"},
            "K": {"name": "stop_price", "type": "float", "format": "price"},
            "L": {"name": "target_3r", "type": "float", "format": "price"},
            "M": {"name": "target_calc", "type": "float", "format": "price"},
            "N": {"name": "target_used", "type": "float", "format": "price"},
            "O": {"name": "exit_price", "type": "float", "format": "price"},
            "P": {"name": "exit_time", "type": "time", "format": "HH:MM:SS"},
            "Q": {"name": "exit_reason", "type": "string", "values": ["STOP", "TARGET_3R", "TARGET_CALC", "CHOCH", "EOD"]},
            "R": {"name": "pnl_dollars", "type": "float", "format": "currency"},
            "S": {"name": "pnl_r", "type": "float", "format": "decimal"},
            "T": {"name": "risk", "type": "float", "format": "price"},
            "U": {"name": "win", "type": "integer", "values": [0, 1]}
        }
    },
    
    "trade_id_format": {
        "description": "Unique identifier for each trade",
        "format": "{ticker}_{MMDDYY}_{model}_{HHMM}",
        "components": {
            "ticker": "Stock symbol (e.g., LLY, AVGO)",
            "MMDDYY": "Trade date in MMDDYY format (e.g., 120925 = Dec 9, 2025)",
            "model": "Entry model (EPCH1, EPCH2, EPCH3, EPCH4)",
            "HHMM": "Entry time in 24-hour format (e.g., 1450 = 2:50 PM)"
        },
        "examples": [
            "LLY_120925_EPCH2_1450",
            "AVGO_120925_EPCH1_0935",
            "AMZN_120925_EPCH3_1115"
        ]
    },
    
    "summary": {
        "description": "Backtest summary statistics",
        "start_column": "W",
        "start_row": 2,
        "sections": {
            "header": {
                "row_offset": 0,
                "fields": ["BACKTEST SUMMARY"]
            },
            "run_info": {
                "row_offset": 1,
                "fields": ["Run Date", "Generated"]
            },
            "overall_stats": {
                "row_offset": 4,
                "fields": [
                    "Total Trades",
                    "Wins",
                    "Losses",
                    "Win Rate",
                    "",
                    "Gross Profit",
                    "Gross Loss",
                    "Net P&L",
                    "Profit Factor",
                    "",
                    "Total R",
                    "Avg Win R",
                    "Avg Loss R",
                    "Expectancy"
                ]
            },
            "by_model": {
                "row_offset": 20,
                "header": "BY MODEL",
                "fields": [
                    "EPCH1 (Primary Cont)",
                    "EPCH2 (Primary Rej)",
                    "EPCH3 (Secondary Cont)",
                    "EPCH4 (Secondary Rej)"
                ]
            },
            "by_exit": {
                "row_offset": 27,
                "header": "BY EXIT TYPE",
                "fields": [
                    "STOP",
                    "TARGET_3R",
                    "TARGET_CALC",
                    "CHOCH",
                    "EOD"
                ]
            }
        }
    },
    
    "model_definitions": {
        "EPCH1": {
            "name": "PRIMARY_CONTINUATION",
            "short_name": "Primary Cont",
            "zone": "PRIMARY",
            "description": "Price traverses through primary zone (continuation)"
        },
        "EPCH2": {
            "name": "PRIMARY_REJECTION",
            "short_name": "Primary Rej",
            "zone": "PRIMARY",
            "description": "Price rejects from primary zone"
        },
        "EPCH3": {
            "name": "SECONDARY_CONTINUATION",
            "short_name": "Secondary Cont",
            "zone": "SECONDARY",
            "description": "Price traverses through secondary zone (continuation)"
        },
        "EPCH4": {
            "name": "SECONDARY_REJECTION",
            "short_name": "Secondary Rej",
            "zone": "SECONDARY",
            "description": "Price rejects from secondary zone"
        }
    },
    
    "exit_types": {
        "STOP": "M5 close beyond zone boundary stop (zone_low - $0.05 for longs, zone_high + $0.05 for shorts)",
        "TARGET_3R": "Price reaches 3R target",
        "TARGET_CALC": "Price reaches calculated target from Analysis",
        "CHOCH": "M5 Change of Character structure break",
        "EOD": "End of day forced exit at 15:50 ET"
    }
}