{
  "_comment": "Epoch Trading System - Module 08: Visualization Cell Map",
  "_version": "1.1",
  "_organization": "XIII Trading LLC",
  "_module": "08_visualization",
  "_description": "Cell mappings for visual trading report generation and summary export",
  "_directory": "02_zone_system/08_visualization/",
  "_version_notes": "V1.1: Added tier column to zone_results (N), updated Analysis primary (B-L) and secondary (N-X) sections, summary tables expanded for tier",

  "worksheets": {
    "market_overview": "market_overview",
    "bar_data": "bar_data",
    "zone_results": "zone_results",
    "analysis": "Analysis"
  },

  "market_overview_input": {
    "index_structure": {
      "_description": "SPY, QQQ, DIA market direction",
      "_rows": "29-31",
      "columns": {
        "ticker_id": "B",
        "ticker": "C",
        "d1_dir": "F",
        "h4_dir": "I",
        "h1_dir": "L",
        "m15_dir": "O",
        "composite": "R"
      },
      "rows": {
        "SPY": 29,
        "QQQ": 30,
        "DIA": 31
      }
    },
    "ticker_structure": {
      "_description": "Dynamic tickers with structure and levels",
      "_rows": "36-45",
      "columns": {
        "ticker_id": "B",
        "ticker": "C",
        "date": "D",
        "d1_dir": "F",
        "d1_strong": "G",
        "d1_weak": "H",
        "h4_dir": "I",
        "h4_strong": "J",
        "h4_weak": "K",
        "h1_dir": "L",
        "h1_strong": "M",
        "h1_weak": "N",
        "m15_dir": "O",
        "m15_strong": "P",
        "m15_weak": "Q",
        "composite": "R"
      },
      "rows": {
        "t1": 36,
        "t2": 37,
        "t3": 38,
        "t4": 39,
        "t5": 40,
        "t6": 41,
        "t7": 42,
        "t8": 43,
        "t9": 44,
        "t10": 45
      }
    }
  },

  "bar_data_input": {
    "ticker_structure": {
      "_description": "Current price",
      "_rows": "4-13",
      "columns": {
        "price": "E"
      },
      "rows": {
        "t1": 4,
        "t2": 5,
        "t3": 6,
        "t4": 7,
        "t5": 8,
        "t6": 9,
        "t7": 10,
        "t8": 11,
        "t9": 12,
        "t10": 13
      }
    },
    "on_options_metrics": {
      "_description": "ATR values",
      "_rows": "73-82",
      "columns": {
        "m5_atr": "Q",
        "d1_atr": "T"
      },
      "rows": {
        "t1": 73,
        "t2": 74,
        "t3": 75,
        "t4": 76,
        "t5": 77,
        "t6": 78,
        "t7": 79,
        "t8": 80,
        "t9": 81,
        "t10": 82
      }
    },
    "time_hvn": {
      "_description": "Epoch start date and HVN POCs",
      "_rows": "59-68",
      "columns": {
        "ticker": "C",
        "start_date": "E",
        "hvn_poc1": "F",
        "hvn_poc2": "G",
        "hvn_poc3": "H",
        "hvn_poc4": "I",
        "hvn_poc5": "J",
        "hvn_poc6": "K",
        "hvn_poc7": "L",
        "hvn_poc8": "M",
        "hvn_poc9": "N",
        "hvn_poc10": "O"
      },
      "rows": {
        "t1": 59,
        "t2": 60,
        "t3": 61,
        "t4": 62,
        "t5": 63,
        "t6": 64,
        "t7": 65,
        "t8": 66,
        "t9": 67,
        "t10": 68
      }
    }
  },

  "zone_results_input": {
    "_description": "V1.1: All L1-L5 zones with tier classification from Module 06",
    "_rows": "2-N (dynamic)",
    "header_row": 1,
    "data_start_row": 2,
    "columns": {
      "ticker_id": "A",
      "ticker": "B",
      "date": "C",
      "price": "D",
      "direction": "E",
      "zone_id": "F",
      "hvn_poc": "G",
      "zone_high": "H",
      "zone_low": "I",
      "overlaps": "J",
      "score": "K",
      "rank": "L",
      "confluences": "M",
      "tier": "N"
    },
    "_tier_mapping": {
      "L1": "T1",
      "L2": "T1",
      "L3": "T2",
      "L4": "T3",
      "L5": "T3"
    }
  },

  "analysis_input": {
    "setup_strings": {
      "_description": "PineScript setup strings",
      "_rows": "44-53",
      "columns": {
        "ticker": "B",
        "setup_string": "C"
      },
      "rows": {
        "t1": 44,
        "t2": 45,
        "t3": 46,
        "t4": 47,
        "t5": 48,
        "t6": 49,
        "t7": 50,
        "t8": 51,
        "t9": 52,
        "t10": 53
      },
      "format": "PriHigh,PriLow,PriTarget,SecHigh,SecLow,SecTarget"
    },
    "primary_section": {
      "_description": "V1.1: Primary setups B31:L40 (11 columns with tier at I)",
      "_rows": "31-40",
      "_version_note": "V1.1 adds tier column, shifts target_id/target/r_r right by 1",
      "columns": {
        "ticker": "B",
        "direction": "C",
        "ticker_id": "D",
        "zone_id": "E",
        "hvn_poc": "F",
        "zone_high": "G",
        "zone_low": "H",
        "tier": "I",
        "target_id": "J",
        "target": "K",
        "r_r": "L"
      },
      "rows": {
        "t1": 31,
        "t2": 32,
        "t3": 33,
        "t4": 34,
        "t5": 35,
        "t6": 36,
        "t7": 37,
        "t8": 38,
        "t9": 39,
        "t10": 40
      },
      "data_range": "B31:L40"
    },
    "secondary_section": {
      "_description": "V1.1: Secondary setups N31:X40 (11 columns with tier at U)",
      "_rows": "31-40",
      "_version_note": "V1.1 shifts entire section from M to N, adds tier column",
      "columns": {
        "ticker": "N",
        "direction": "O",
        "ticker_id": "P",
        "zone_id": "Q",
        "hvn_poc": "R",
        "zone_high": "S",
        "zone_low": "T",
        "tier": "U",
        "target_id": "V",
        "target": "W",
        "r_r": "X"
      },
      "rows": {
        "t1": 31,
        "t2": 32,
        "t3": 33,
        "t4": 34,
        "t5": 35,
        "t6": 36,
        "t7": 37,
        "t8": 38,
        "t9": 39,
        "t10": 40
      },
      "data_range": "N31:X40"
    }
  },

  "summary_export_output": {
    "_description": "V1.1: Summary tables written by summary_exporter.py for Supabase (includes tier columns)",
    "table_1": {
      "_description": "Core Trading Data (V1.1: 28 columns with tier)",
      "range": "B2:AC12",
      "header_row": 2,
      "data_rows": "3-12",
      "columns": {
        "Ticker": "B",
        "Ticker_ID": "C",
        "Date": "D",
        "Price": "E",
        "Composite": "F",
        "D1_Dir": "G",
        "H4_Dir": "H",
        "H1_Dir": "I",
        "M15_Dir": "J",
        "D1_ATR": "K",
        "M5_ATR": "L",
        "Pri_Dir": "M",
        "Pri_Zone": "N",
        "Pri_POC": "O",
        "Pri_High": "P",
        "Pri_Low": "Q",
        "Pri_Target": "R",
        "Pri_Tier": "S",
        "Pri_RR": "T",
        "Sec_Dir": "U",
        "Sec_Zone": "V",
        "Sec_POC": "W",
        "Sec_High": "X",
        "Sec_Low": "Y",
        "Sec_Target": "Z",
        "Sec_Tier": "AA",
        "Sec_RR": "AB",
        "Zone_Count": "AC"
      }
    },
    "table_2": {
      "_description": "Zone Details & Epoch POCs",
      "range": "B14:V24",
      "header_row": 14,
      "data_rows": "15-24",
      "columns": {
        "Ticker": "B",
        "Ticker_ID": "C",
        "Date": "D",
        "Top_Zone_ID": "E",
        "Top_Zone_POC": "F",
        "Top_Zone_Rank": "G",
        "Top_Zone_Score": "H",
        "Epoch_Start": "I",
        "POC1": "J",
        "POC2": "K",
        "POC3": "L",
        "POC4": "M",
        "POC5": "N",
        "POC6": "O",
        "POC7": "P",
        "POC8": "Q",
        "POC9": "R",
        "POC10": "S",
        "PineScript_6": "T",
        "PineScript_16": "U",
        "Export_Time": "V"
      }
    }
  },

  "chart_configuration": {
    "candle_timeframe_minutes": 60,
    "candle_bar_count": 240,
    "vbp_timeframe_minutes": 15,
    "dpi": 300,
    "figure_width_inches": 20,
    "figure_height_inches": 12
  },

  "color_scheme": {
    "primary_zone_fill": {"hex": "#90bff9", "alpha": 0.15},
    "secondary_zone_fill": {"hex": "#faa1a4", "alpha": 0.15},
    "primary_target_line": "#90bff9",
    "secondary_target_line": "#faa1a4",
    "bullish_candle": "#26a69a",
    "bearish_candle": "#ef5350",
    "vp_color": "#5c6bc0",
    "poc_lines": {"color": "#ffffff", "alpha": 0.3, "style": "dashed"},
    "background": "#1a1a2e"
  },

  "pinescript_format": {
    "6_value": "PriHigh,PriLow,PriTarget,SecHigh,SecLow,SecTarget",
    "16_value": "PriHigh,PriLow,PriTarget,SecHigh,SecLow,SecTarget,POC1,POC2,POC3,POC4,POC5,POC6,POC7,POC8,POC9,POC10"
  },

  "cell_reference_examples": {
    "SPY_composite": "R29",
    "t1_epoch_start": "E59",
    "t1_hvn_poc1": "F59",
    "t1_setup_string": "C44",
    "t1_primary_tier": "I31",
    "t1_secondary_tier": "U31",
    "zone_results_tier_first": "N2",
    "summary_table1_start": "B2",
    "summary_table2_start": "B14"
  }
}
