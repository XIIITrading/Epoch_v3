{
  "_comment": "Epoch Trading System - Module 06: Zone Results Cell Map",
  "_version": "1.1",
  "_organization": "XIII Trading LLC",
  "_module": "06_zone_results",
  "_description": "Cell mappings for filtered actionable trading zones",
  "_directory": "02_zone_system/06_zone_results/",
  "_version_notes": "V1.1: All ranks (L1-L5) included, tier classification added, proximity-based selection, tier column N, setup columns shifted O-T",

  "input_worksheet": "raw_zones",
  "output_worksheet": "zone_results",
  "price_atr_worksheet": "bar_data",

  "raw_zones_input": {
    "_description": "All zones (L1-L5) read from raw_zones worksheet",
    "header_row": 1,
    "data_start_row": 2,
    "columns": {
      "ticker_id": "A",
      "ticker": "B",
      "date": "C",
      "price": "D",
      "direction": "E",
      "zone_id": "F",
      "hvn_poc": "G",
      "zone_high": "H",
      "zone_low": "I",
      "overlaps": "J",
      "score": "K",
      "rank": "L",
      "confluences": "M"
    }
  },

  "bar_data_input": {
    "_description": "Price and ATR for proximity calculations",
    "ticker_structure": {
      "_rows": "4-13",
      "columns": {
        "ticker_id": "B",
        "price": "E"
      }
    },
    "on_options_metrics": {
      "_rows": "73-82",
      "columns": {
        "d1_atr": "T"
      }
    },
    "rows": {
      "t1": {"ticker_row": 4, "atr_row": 73},
      "t2": {"ticker_row": 5, "atr_row": 74},
      "t3": {"ticker_row": 6, "atr_row": 75},
      "t4": {"ticker_row": 7, "atr_row": 76},
      "t5": {"ticker_row": 8, "atr_row": 77},
      "t6": {"ticker_row": 9, "atr_row": 78},
      "t7": {"ticker_row": 10, "atr_row": 79},
      "t8": {"ticker_row": 11, "atr_row": 80},
      "t9": {"ticker_row": 12, "atr_row": 81},
      "t10": {"ticker_row": 13, "atr_row": 82}
    }
  },

  "tier_classification": {
    "_description": "V1.1: Quality tier mapping from L-ranks",
    "tier_mapping": {
      "L1": "T1",
      "L2": "T1",
      "L3": "T2",
      "L4": "T3",
      "L5": "T3"
    },
    "tier_descriptions": {
      "T1": "Lower Quality",
      "T2": "Medium Quality",
      "T3": "High Quality"
    },
    "_note": "Selection is proximity-based, tier indicates quality for trader discretion"
  },

  "zone_results_output": {
    "_description": "Filtered zones (L1-L5, within 2 ATR, non-overlapping) with tier classification",
    "header_row": 1,
    "data_start_row": 2,
    "module_06_columns": {
      "_description": "Columns A-N written by Module 06",
      "ticker_id": "A",
      "ticker": "B",
      "date": "C",
      "price": "D",
      "direction": "E",
      "zone_id": "F",
      "hvn_poc": "G",
      "zone_high": "H",
      "zone_low": "I",
      "overlaps": "J",
      "score": "K",
      "rank": "L",
      "confluences": "M",
      "tier": "N"
    },
    "module_07_columns": {
      "_description": "Columns O-T reserved for Module 07 (Setup Analysis)",
      "epch_bull": "O",
      "epch_bear": "P",
      "epch_bull_price": "Q",
      "epch_bear_price": "R",
      "epch_bull_target": "S",
      "epch_bear_target": "T"
    }
  },

  "filtering_configuration": {
    "valid_ranks": ["L1", "L2", "L3", "L4", "L5"],
    "_v1.1_note": "All ranks now included - selection is proximity-based, tier indicates quality",
    "proximity_thresholds": {
      "group_1": {
        "max_atr_distance": 1.0,
        "description": "Immediate relevance"
      },
      "group_2": {
        "max_atr_distance": 2.0,
        "description": "Near-term relevance"
      },
      "excluded": {
        "atr_distance": ">2.0",
        "description": "Too far from current price"
      }
    },
    "max_zones_per_ticker": 10
  },

  "internal_calculations": {
    "_description": "Calculated internally but NOT written to worksheet",
    "zone_midpoint": "(zone_high + zone_low) / 2",
    "distance": "abs(zone_midpoint - price)",
    "atr_distance": "distance / d1_atr",
    "proximity_group": "1 if atr_distance <= 1.0, 2 if <= 2.0, None if > 2.0"
  },

  "sorting_priority": {
    "1": "ticker_id (ascending)",
    "2": "proximity_group (ascending - closer first)",
    "3": "score (descending - higher scores first)",
    "4": "atr_distance (ascending - closer first)"
  },

  "overlap_elimination": {
    "_description": "Highest score wins when zones overlap",
    "overlap_check": "zone1_low < zone2_high AND zone1_high > zone2_low",
    "selection_rule": "First zone in sorted order wins, overlapping zones skipped"
  },

  "cell_reference_examples": {
    "first_zone_ticker_id": "A2",
    "first_zone_rank": "L2",
    "first_zone_confluences": "M2",
    "first_zone_tier": "N2",
    "first_zone_epch_bull": "O2",
    "first_zone_epch_bear_target": "T2",
    "t1_price": "E4",
    "t1_d1_atr": "T73"
  }
}
